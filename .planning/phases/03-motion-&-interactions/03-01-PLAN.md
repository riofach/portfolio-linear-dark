---
phase: 03-motion-&-interactions
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/layout.tsx
  - src/app/template.tsx
  - src/lib/motion.ts
  - src/components/ui/fade-in.tsx
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Native browser scrolling is active (no Lenis)"
    - "Page content crossfades on route changes"
    - "Motion primitives (FadeIn) are available for import"
  artifacts:
    - path: "src/lib/motion.ts"
      provides: "Centralized animation constants"
      exports: ["SPRING_SUBTLE", "STAGGER_CHILDREN", "FADE_UP_VARIANTS"]
    - path: "src/app/template.tsx"
      provides: "Page transition wrapper"
      contains: "motion.div"
    - path: "src/components/ui/fade-in.tsx"
      provides: "Reusable scroll reveal component"
      exports: ["FadeIn"]
  key_links:
    - from: "src/app/template.tsx"
      to: "src/lib/motion.ts"
      via: "import constants"
---

<objective>
Establish the motion infrastructure, remove conflicting scroll libraries, and implement page transitions.

Purpose: Foundation for the "linear-dark" motion language and compliance with "Native browser scroll" requirement.
Output: Motion configuration, transition template, and reusable reveal components.
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/phases/03-motion-&-interactions/03-CONTEXT.md
@.planning/phases/03-motion-&-interactions/03-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Setup Motion Config & Cleanup</name>
  <files>src/lib/motion.ts, src/app/layout.tsx</files>
  <action>
    1. Create `src/lib/motion.ts` with "Linear" style constants:
       - `SPRING_SUBTLE`: { type: "spring", stiffness: 300, damping: 30, mass: 1 }
       - `SPRING_SLOW`: { type: "spring", stiffness: 200, damping: 40, mass: 1 }
       - `FADE_UP_VARIANTS`: hidden { opacity: 0, y: 20 }, show { opacity: 1, y: 0 }
       - `STAGGER_CHILDREN`: staggerChildren: 0.1
    2. Edit `src/app/layout.tsx`:
       - REMOVE `ReactLenis` import and wrapper.
       - Ensure `<html>` and `<body>` allow native scrolling.
  </action>
  <verify>
    - Check `src/lib/motion.ts` exists.
    - Check `src/app/layout.tsx` does NOT contain "lenis".
  </verify>
  <done>Motion constants defined, Lenis removed.</done>
</task>

<task type="auto">
  <name>Task 2: Create Page Transitions</name>
  <files>src/app/template.tsx</files>
  <action>
    Create `src/app/template.tsx` (client component):
    - Import `motion` from "motion/react".
    - Export a default function taking `children`.
    - Return `children` wrapped in `<motion.div>` with:
      - `initial={{ opacity: 0 }}`
      - `animate={{ opacity: 1 }}`
      - `exit={{ opacity: 0 }}`
      - `transition={{ duration: 0.5, ease: "easeInOut" }}`
    - Ensure it does NOT conflict with layout structure.
  </action>
  <verify>
    - File exists.
    - Contains motion.div wrapper with exit prop.
  </verify>
  <done>Page transitions implemented via template.</done>
</task>

<task type="auto">
  <name>Task 3: Create FadeIn Component</name>
  <files>src/components/ui/fade-in.tsx</files>
  <action>
    Create `src/components/ui/fade-in.tsx`:
    - Client component.
    - Props: `children`, `delay` (default 0), `className`.
    - Wrapper: `<motion.div>`
    - Logic:
      - `initial="hidden"`, `whileInView="show"`
      - `viewport={{ once: true, margin: "-10%" }}` (trigger early, play once)
      - Variants: Use `FADE_UP_VARIANTS` from `src/lib/motion.ts`.
      - Transition: Use `SPRING_SUBTLE` with dynamic `delay`.
  </action>
  <verify>
    - File exists and exports FadeIn.
  </verify>
  <done>Reusable FadeIn component ready.</done>
</task>

</tasks>

<verification>
- `grep "lenis" src/app/layout.tsx` returns nothing.
- `src/lib/motion.ts` exports `SPRING_SUBTLE`.
- `src/app/template.tsx` exists.
</verification>

<success_criteria>
- Native scroll restored.
- Motion config centralized.
- Components ready for Phase 3-02.
</success_criteria>

<output>
After completion, create `.planning/phases/03-motion-&-interactions/03-01-SUMMARY.md`
</output>
