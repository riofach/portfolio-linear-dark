---
phase: 03-motion-interactions
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/lib/validations/contact.ts
  - src/components/sections/Contact.tsx
  - src/actions/contact.ts
autonomous: true
must_haves:
  truths:
    - "User receives error messages for invalid input"
    - "Form submits successfully with valid input"
    - "Submit button shows loading state"
  artifacts:
    - path: "src/lib/validations/contact.ts"
      provides: "Zod schema"
    - path: "src/actions/contact.ts"
      provides: "Server action"
  key_links:
    - from: "src/components/sections/Contact.tsx"
      to: "src/actions/contact.ts"
      via: "form action or onSubmit"
---

<objective>
Implement robust form validation and state management for the Contact section.

Purpose: Ensure data integrity and user feedback.
Output: Validated Contact Form with Server Action.
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Dependencies</name>
  <files>package.json</files>
  <action>
    Install:
    - `zod`
    - `react-hook-form`
    - `@hookform/resolvers`
  </action>
  <verify>grep "zod" package.json</verify>
  <done>Libraries installed.</done>
</task>

<task type="auto">
  <name>Task 2: Define Validation Schema</name>
  <files>src/lib/validations/contact.ts</files>
  <action>
    Create schema:
    - name: min 2 chars
    - email: valid email
    - message: min 10 chars
  </action>
  <verify>File exists with Zod schema export.</verify>
  <done>Schema defined.</done>
</task>

<task type="auto">
  <name>Task 3: Create Server Action</name>
  <files>src/actions/contact.ts</files>
  <action>
    Create `contactAction(prevState, formData)`:
    - Validate formData against Zod schema.
    - If valid: Return success: true, message: "Thanks!" (Simulate delay).
    - If invalid: Return success: false, errors.
    - *Note:* No actual email service integration required yet (unless simulating).
  </action>
  <verify>File exists.</verify>
  <done>Server action ready.</done>
</task>

<task type="auto">
  <name>Task 4: Implement Client Form</name>
  <files>src/components/sections/Contact.tsx</files>
  <action>
    Refactor Contact form:
    - Use `useForm` with `zodResolver`.
    - Handle `onSubmit` calling the Server Action (or use `useActionState` if Next.js 15+, but `useForm` is easier for client validation feedback).
    - *Decision:* Use Client Component approach (`useForm`) wrapping the Server Action execution to get immediate UI feedback.
    - Show inline error messages (red text).
    - Disable submit button while `isSubmitting`.
  </action>
  <verify>Try submitting empty form -> errors. Valid form -> success.</verify>
  <done>Form validation functional.</done>
</task>

</tasks>

<verification>
- Test empty submission.
- Test invalid email.
- Test valid submission.
</verification>

<success_criteria>
- Form prevents invalid submission.
- Loading state is visible.
- Success message appears after submission.
</success_criteria>

<output>
After completion, create `.planning/phases/03-motion-interactions/03-04-SUMMARY.md`
</output>
