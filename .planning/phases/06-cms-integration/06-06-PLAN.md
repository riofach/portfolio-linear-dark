---
phase: 06-cms-integration
plan: 06
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/page.tsx
  - src/components/sections/Experience.tsx
  - src/components/sections/Skills.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "User can see Experience content fetched from Sanity"
    - "User can see Skills content fetched from Sanity"
    - "Experience component accepts data via props"
    - "Skills component accepts data via props"
  artifacts:
    - path: "src/app/page.tsx"
      provides: "Data fetching for Experience and Skills"
      contains: "sanityFetch<Experience[]>"
    - path: "src/components/sections/Experience.tsx"
      provides: "Dynamic Experience rendering"
      contains: "interface ExperienceProps"
    - path: "src/components/sections/Skills.tsx"
      provides: "Dynamic Skills rendering"
      contains: "interface SkillsProps"
  key_links:
    - from: "src/app/page.tsx"
      to: "sanity/lib/queries.ts"
      via: "experiencesQuery, skillsQuery"
    - from: "src/app/page.tsx"
      to: "src/components/sections/Experience.tsx"
      via: "experiences prop"
---

<objective>
Integrate Experience and Skills sections with Sanity CMS data, replacing static data files.

Purpose: Complete the homepage CMS integration by connecting the remaining static sections to dynamic data.
Output: Updated homepage and components using real CMS data.
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@src/app/page.tsx
@sanity/lib/queries.ts
@src/types/sanity.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fetch Experience and Skills Data in Homepage</name>
  <files>src/app/page.tsx</files>
  <action>
    Update `src/app/page.tsx`:
    1. Import `experiencesQuery` and `skillsQuery` from `../../sanity/lib/queries`.
    2. Import `Experience` and `Skill` types from `@/types/sanity`.
    3. Fetch `experiences` using `sanityFetch<Experience[]>({ query: experiencesQuery })`.
    4. Fetch `skills` using `sanityFetch<Skill[]>({ query: skillsQuery })`.
    5. Pass `experiences` to `<Experience />` and `skills` to `<Skills />` components (types will be fixed in next tasks).
    
    Ensure `revalidate` remains set to 60.
  </action>
  <verify>
    Check file content to ensure `sanityFetch` calls are present and correct queries are used.
  </verify>
  <done>
    Homepage fetches all required data from Sanity.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update Experience Component to Accept Props</name>
  <files>src/components/sections/Experience.tsx</files>
  <action>
    Refactor `src/components/sections/Experience.tsx`:
    1. Remove import of static data from `@/data/experience`.
    2. Import `Experience` type from `@/types/sanity`.
    3. Define `interface ExperienceProps { experiences: Experience[] }`.
    4. Update component to accept `experiences` prop.
    5. Map over the `experiences` prop instead of static data to render items.
    6. Ensure fields match: `company`, `role`, `startDate`, `endDate`, `description`.
    7. Handle optional fields like `endDate` (if `current` is true).
  </action>
  <verify>
    Verify static import is removed.
    Check that `ExperienceProps` interface is defined and exported.
  </verify>
  <done>
    Experience component renders dynamic data passed via props.
  </done>
</task>

<task type="auto">
  <name>Task 3: Update Skills Component to Accept Props</name>
  <files>src/components/sections/Skills.tsx</files>
  <action>
    Refactor `src/components/sections/Skills.tsx`:
    1. Remove import of static data from `@/data/skills`.
    2. Import `Skill` type from `@/types/sanity`.
    3. Define `interface SkillsProps { skills: Skill[] }`.
    4. Update component to accept `skills` prop.
    5. Map over the `skills` prop instead of static data.
    6. Group skills by `category` if the UI requires it (check static data structure), or render as is if flat list.
    7. Use `urlFor` (from `@/sanity/lib/image`) for skill icons if `icon` field is used and present.
  </action>
  <verify>
    Run `npm run build`.
    Verify static import is removed.
  </verify>
  <done>
    Skills component renders dynamic data passed via props.
  </done>
</task>

</tasks>

<verification>
Verify that `src/app/page.tsx` passes data to child components and child components use that data.
Verify no static data imports (`@/data/...`) remain in these files.
</verification>

<success_criteria>
1. Homepage loads without errors.
2. Experience section displays data from Sanity.
3. Skills section displays data from Sanity.
4. No static data dependencies in these sections.
</success_criteria>

<output>
After completion, create `.planning/phases/06-cms-integration/06-06-SUMMARY.md`
</output>
