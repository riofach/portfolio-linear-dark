---
phase: 06-cms-integration
plan: 07
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/projects/[slug]/page.tsx
  - src/app/blog/[slug]/page.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "User can view individual Project details by slug"
    - "User can view individual Blog Post details by slug"
    - "Pages are statically generated or revalidated"
  artifacts:
    - path: "src/app/projects/[slug]/page.tsx"
      provides: "Project Detail Page"
      exports: ["generateStaticParams", "default"]
    - path: "src/app/blog/[slug]/page.tsx"
      provides: "Blog Post Detail Page"
      exports: ["generateStaticParams", "default"]
  key_links:
    - from: "src/app/projects/[slug]/page.tsx"
      to: "sanity/lib/queries.ts"
      via: "projectQuery"
    - from: "src/app/blog/[slug]/page.tsx"
      to: "sanity/lib/queries.ts"
      via: "postQuery"
---

<objective>
Create dynamic detail pages for Projects and Blog Posts, enabling users to view full content for each item fetched from Sanity.

Purpose: Provide dedicated pages for portfolio projects and blog articles, which are currently missing (404s).
Output: Working `[slug]` pages for projects and blog posts.
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@sanity/lib/queries.ts
@src/types/sanity.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Project Detail Page</name>
  <files>src/app/projects/[slug]/page.tsx</files>
  <action>
    Create `src/app/projects/[slug]/page.tsx`:
    1. Import `sanityFetch`, `projectQuery`, `projectsQuery`.
    2. Import `Project` type.
    3. Implement `generateStaticParams`:
       - Fetch all projects using `projectsQuery`.
       - Return array of params `{ slug: project.slug }`.
    4. Implement default page component `ProjectPage({ params })`:
       - Await `params` (Next.js 15+ requirement).
       - Fetch project using `sanityFetch<Project>({ query: projectQuery, params: { slug } })`.
       - Handle 404 if not found (`notFound()`).
       - Render project details:
         - Title, Description, Tags.
         - Links (Demo, Repo).
         - Image (use `urlFor` and `Image` component).
    5. Use a simple, clean layout consistent with the site design.
  </action>
  <verify>
    Check if file exists and exports required functions.
  </verify>
  <done>
    Project detail page exists and fetches data based on slug.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Blog Post Detail Page</name>
  <files>src/app/blog/[slug]/page.tsx</files>
  <action>
    Create `src/app/blog/[slug]/page.tsx`:
    1. Import `sanityFetch`, `postQuery`, `postsQuery`.
    2. Import `Post` type.
    3. Import `PortableText` from `@portabletext/react`.
    4. Implement `generateStaticParams`:
       - Fetch all posts using `postsQuery`.
       - Return array of params `{ slug: post.slug }`.
    5. Implement default page component `BlogPostPage({ params })`:
       - Await `params`.
       - Fetch post using `sanityFetch<Post>({ query: postQuery, params: { slug } })`.
       - Handle 404 if not found.
       - Render post details:
         - Title, Published Date (formatted), Author.
         - Main Image (if exists).
         - Body content using `<PortableText value={post.body} />`.
    6. Add basic styling to `PortableText` container (e.g., `prose prose-invert` if Tailwind typography is available, or custom styles).
  </action>
  <verify>
    Check if file exists and exports required functions.
  </verify>
  <done>
    Blog post detail page exists and renders Portable Text content.
  </done>
</task>

</tasks>

<verification>
Verify both pages implement `generateStaticParams` for SSG/ISR support.
Verify correct queries are used (`projectQuery`, `postQuery`).
Verify 404 handling is present.
</verification>

<success_criteria>
1. navigating to `/projects/some-slug` renders project details.
2. navigating to `/blog/some-slug` renders blog post content.
3. Build process generates static paths for existing content.
</success_criteria>

<output>
After completion, create `.planning/phases/06-cms-integration/06-07-SUMMARY.md`
</output>
